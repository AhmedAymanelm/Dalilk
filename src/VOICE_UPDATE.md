# ๐ค ุชุญุฏูุซุงุช Voice System

## โ ูุง ุชู ุฅุตูุงุญู:

### ุงููุดููุฉ:
- ูุงู ุงูู Voice Chat ูุฑุฌุน ุงูุตูุช ูุงููุต ุจุณุ ุจุฏูู ุงูุชุฑุดูุญุงุช (ุงูุณูุงุฑุงุช)

### ุงูุญู:
ุชู ุชุญุฏูุซ endpoint `/api/v1/voice-whisper/voice-chat` ูู ููู `voice_whisper.py` ููุดูู:

1. **ุฌูุจ ุจูุงูุงุช ุงูุณูุงุฑุงุช ุงููุงููุฉ** ูู ูููุงุช ุงููุดุฑูุน
2. **ูุทุงุจูุฉ ุงูุณูุงุฑุงุช** ูุน ุงูู retrieved documents ูู RAG
3. **ุฅุฑุฌุงุน ุงูุณูุงุฑุงุช** ูู ุงูู response ูุน ุงูุตูุช ูุงููุต

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู:

### ุชุดุบูู ุงูุณูุฑูุฑ:
```bash
cd "/Users/ahmed/Desktop/Graduation project/Ai/src"
source ../venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8000
```

### ุงุณุชุฎุฏุงู ุงูุชุณุฌูู ุงูุตูุชู ุงูุชูุงุนูู:
```bash
python voice_record.py test_session
```

**ุงูุฎุทูุงุช:**
1. ุงุถุบุท Enter ููุจุฏุก ูู ุงูุชุณุฌูู
2. ุชููู ูุงุณุฃู ุนู ุงูุณูุงุฑุงุช (ูุซุงู: "ุนุงูุฒ ุนุฑุจูุฉ ูู ุญุฏูุฏ 200 ุฃูู")
3. ุงุถุบุท Enter ูุฑุฉ ุชุงููุฉ ููุฅููุงุก
4. ุงูุชุธุฑ ุดููุฉ ูููุนุงูุฌุฉ
5. ูุชุดูู:
   - ๐ ุงููุต ุงููู ููุชู
   - ๐ค ุฑุฏ ุงูุจูุช
   - ๐ ุงูุณูุงุฑุงุช ุงูููุชุฑุญุฉ (ุงุณูุ ุณุนุฑุ ุชููููุ ุตูุฑุ ููุงุตูุงุช)
   - ๐พ ุงูุตูุช ูุญููุธ
   - ๐ ุงุฎุชูุงุฑ ุชุดุบูู ุงูุตูุช

---

## ๐ Response Format:

```json
{
  "success": true,
  "transcript": "ุงููุต ุงููุณุชุฎุฑุฌ ูู ุงูุตูุช",
  "response_text": "ุฑุฏ ุงูุจูุช",
  "cars": [
    {
      "name": "ุงุณู ุงูุณูุงุฑุฉ",
      "price": "ุงูุณุนุฑ",
      "rating": "ุงูุชูููู",
      "id": "ูุนุฑู ุงูุณูุงุฑุฉ",
      "images": ["ุฑุงุจุท ุงูุตูุฑุฉ"],
      "specs": {
        "engine": "ุงููุญุฑู",
        "transmission": "ูุงูู ุงูุญุฑูุฉ",
        ...
      },
      "rating_text": "ูุตู ุงูุชูููู",
      "score": 0.95
    }
  ],
  "audio_base64": "ุงูุตูุช ุจุตูุบุฉ base64",
  "audio_format": "mp3"
}
```

---

## ๐ง ุงูุชุนุฏููุงุช ุงูุชูููุฉ:

### ูู `voice_whisper.py`:
- ุชูุช ุฅุถุงูุฉ ููุฏ ุฌูุจ ุงูุณูุงุฑุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุชูุช ุฅุถุงูุฉ ููุฏ ุงููุทุงุจูุฉ ุจูู retrieved_docs ูุงูุณูุงุฑุงุช
- ุชูุช ุฅุถุงูุฉ `cars` ููู response

### ุงูุฃููุงุฏ ุงููุถุงูุฉ (ุงูุณุทูุฑ 143-217):
```python
# ุฌูุจ ุจูุงูุงุช ุงูุณูุงุฑุงุช ูู retrieved_docs
cars = []
try:
    from models.AssetModel import AssetModel
    # ... ุฌูุจ ุงููููุงุช
    # ... ูุทุงุจูุฉ ุงูุณูุงุฑุงุช ูุน retrieved_docs
    # ... ุฅุถุงูุฉ ุงูุณูุงุฑุงุช ููู response
except Exception as e:
    logger.error(f"Error loading car data: {e}")
```

---

## ๐ก ููุงุญุธุงุช:

1. **ููุถู ุงุณุชุฎุฏุงู** `voice-whisper` endpoint ุจุฏู `voice` ุงูุนุงุฏู ูุฃูู:
   - ุจุฏูู quota limits ูู Google
   - ุฃุณุฑุน
   - ุฃุฏู ูู ุงูุชุนุฑู ุนูู ุงูุตูุช ุงูุนุฑุจู

2. **ุงูุณูุงุฑุงุช ุงููุนุฑูุถุฉ** ุจุชููู ูุฑุชุจุฉ ุญุณุจ relevance score ูู RAG

3. **ุงูุตูุช ุจูุชุญูุธ** ูู ููู mp3 ูููู ุชุดุบููู ุจุนุฏูู

---

## ๐ ูู ุญุงูุฉ ุงููุดุงูู:

### ุงูุณูุฑูุฑ ูุด ุดุบุงู:
```bash
lsof -ti:8000 | xargs kill -9
source ../venv/bin/activate
uvicorn main:app --host 0.0.0.0 --port 8000
```

### ุงูุชุณุฌูู ุงูุตูุชู ูุด ุดุบุงู:
ุชุฃูุฏ ูู ุชุซุจูุช ffmpeg:
```bash
brew install ffmpeg
```

### ูุด ุจูุฌููู ุณูุงุฑุงุช:
- ุชุฃูุฏ ุฅู ูู ูููุงุช JSON ูู ูุฌูุฏ `assets/files/default/`
- ุชุฃูุฏ ุฅู ุงูุณุคุงู ูุชุนูู ุจุงูุณูุงุฑุงุช
- ุดูู ุงูู logs ูู terminal ุงูุณูุฑูุฑ

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-12-21
